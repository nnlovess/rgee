<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Setup and Details • rgee</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Setup and Details">
<meta property="og:description" content="rgee">
<meta property="og:image" content="http://r-spatial.github.io/rgee/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rgee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/setup.html">Setup and details</a>
    </li>
    <li>
      <a href="../articles/considerations.html">Consideration</a>
    </li>
    <li>
      <a href="../articles/BestPractices.html">Best Practices</a>
    </li>
    <li>
      <a href="http://csaybar.github.io/rgee-examples/">rgee examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/r-spatial/rgee/">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="setup_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="setup_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="setup_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Setup and Details</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/rgee/blob/master/vignettes/setup.Rmd"><code>vignettes/setup.Rmd</code></a></small>
      <div class="hidden name"><code>setup.Rmd</code></div>

    </div>

    
    
<p><code>rgee</code> has two types of dependencies: <span style="color:#b52b09"><strong>strict dependencies</strong></span> that must be satisfied before the <code>rgee</code> installation and the <span style="color:#857e04"><b>credentials dependencies</b></span> that unlock <code>rgee</code> import &amp; export functions.</p>
<p>If the first group of dependencies is not fulfilled <strong>rgee just will not work</strong>. The dependencies that comprised this group are:</p>
<ul>
<li><span style="color:#b52b09"><b> Google account with Earth Engine activated </b></span></li>
<li><span style="color:#b52b09"><b> Python &gt;= v3.5 </b></span></li>
<li><span style="color:#b52b09"><b> EarthEngine Python API (Python package) </b></span></li>
</ul>
<p>The activation of <strong>Earth Engine accounts</strong> depends on each user, check the oficial website of <a href="https://earthengine.google.com/">Google Earth Engine</a> for more details. If you do not count with a Python environment or a version of the EarthEngine Python API, we strongly recommend you run <code><a href="../reference/ee_install.html">ee_install(py_env = "rgee")</a></code>. This function will realize the following six tasks:</p>
<ol style="list-style-type: decimal">
<li>If you do not count with a Python environment, it will display an interactive menu to install <a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a> (a free minimal installer for conda).</li>
<li>Remove the previous Python environment defined in py_env if it exist.</li>
<li>Create a new Python environment.</li>
<li>Set the environmental variable EARTHENGINE_PYTHON. It is used to define RETICULATE_PYTHON when the library is loaded. See this article for further details.</li>
<li>Install rgee Python dependencies. Using <code><a href="https://rdrr.io/pkg/reticulate/man/py_install.html">reticulate::py_install</a></code>.</li>
<li>Interactive menu to confirm if restart the R session to see changes.</li>
</ol>
<p>However, the use of <code><a href="../reference/ee_install.html">ee_install()</a></code> is not mandatory. You can count on with your own custom installation. This would be also allowed.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/rgee">rgee</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/ee_install.html">ee_install</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># It is just neccessary once!</span></code></pre></div>
<p>By the other hand, the <span style="color:#857e04"><b>credentials dependencies</b></span> are only needed to move data from Google Drive and Google Cloud Storage to your local environment. These dependencies are not mandatory. However, they will help you to create a seamless connection between R and Earth Engine. The dependencies that comprised this group are shown below:</p>
<ul>
<li><span style="color:#857e04"><strong>Google Cloud Storage credential</strong></span></li>
<li><span style="color:#857e04"><strong>Google Drive credential</strong></span></li>
</ul>
<div id="import-and-export-spatial-data-using-rgee" class="section level2">
<h2 class="hasAnchor">
<a href="#import-and-export-spatial-data-using-rgee" class="anchor"></a>Import and Export Spatial Data using rgee</h2>
<p>The batch import/export involves difficulties for most GEE users. In <code>rgee</code>, we are aware of it and we created several functions to help users to download and upload spatial data. If you are trying to <strong>export data</strong> from Earth Engine, rgee offers the following options:</p>
<table class="table">
<caption>Table 1. Download functions provided by the rgee package.</caption>
<thead><tr class="header">
<th></th>
<th></th>
<th align="center">FROM</th>
<th align="center">TO</th>
<th align="center">RETURN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Image</td>
<td>ee_image_to_drive</td>
<td align="center">EE server</td>
<td align="center">Drive</td>
<td align="center">Unstarted task</td>
</tr>
<tr class="even">
<td></td>
<td>ee_image_to_gcs</td>
<td align="center">EE server</td>
<td align="center">Cloud Storage</td>
<td align="center">Unstarted task</td>
</tr>
<tr class="odd">
<td></td>
<td>ee_image_to_asset</td>
<td align="center">EE server</td>
<td align="center">EE asset</td>
<td align="center">Unstarted task</td>
</tr>
<tr class="even">
<td></td>
<td><strong>ee_as_raster</strong></td>
<td align="center">EE server</td>
<td align="center">Local</td>
<td align="center">RasterStack object</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>ee_as_stars</strong></td>
<td align="center">EE server</td>
<td align="center">Local</td>
<td align="center">Proxy-stars object</td>
</tr>
<tr class="even">
<td>Table</td>
<td>ee_table_to_drive</td>
<td align="center">EE server</td>
<td align="center">Drive</td>
<td align="center">Unstarted task</td>
</tr>
<tr class="odd">
<td></td>
<td>ee_table_to_gcs</td>
<td align="center">EE server</td>
<td align="center">Cloud Storage</td>
<td align="center">Unstarted task</td>
</tr>
<tr class="even">
<td></td>
<td>ee_table_to_asset</td>
<td align="center">EE server</td>
<td align="center">EE asset</td>
<td align="center">Unstarted task</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>ee_as_sf</strong></td>
<td align="center">EE server</td>
<td align="center">Local</td>
<td align="center">sf object</td>
</tr>
<tr class="even">
<td>Generic</td>
<td>ee_drive_to_local</td>
<td align="center">Drive</td>
<td align="center">Local</td>
<td align="center">object filename</td>
</tr>
<tr class="odd">
<td></td>
<td>ee_gcs_to_local</td>
<td align="center">Cloud Storage</td>
<td align="center">Local</td>
<td align="center">GCS filename</td>
</tr>
</tbody>
</table>
<p>In <code>rgee</code>, all the functions from server to local side have the option to fetch data using an intermediate container (Google Drive or Google Cloud Storage) or through a REST call (“$getInfo”). Although the latter option performs a quick download, there is a request limit of 262144 pixels for ee$Image and 5000 elements for ee$FeatureCollection which makes it unsuitable for large objects. Other download functions, from server-side to others (see Table 1), are implemented to enable more customized download workflows. For example, using <code>ee_image_to_drive</code> and <code>ee_drive_to_local</code> users could create scripts which save results in the <code>.TFRecord</code> rather than the <code>.GeoTIFF</code> format. <code>rgee</code> to deal with <strong>Google Drive</strong> and <strong>Google Cloud Storage</strong> use the R package <a href="https://googledrive.tidyverse.org/">googledrive</a> and <a href="http://code.markedmondson.me/googleCloudStorageR/">googleCloudStorageR</a> respectively, so you will need to install it before.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># please try as follow</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'googledrive'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'googleCloudStorageR'</span><span class="op">)</span></code></pre></div>
<p><strong>Google Drive</strong> is more friendly to novice Earth Engine users because the authentication process could be done without leaving R. However, if you are trying to move large images or vectors, is preferable use <strong>Google Cloud Storage</strong> instead. For using Google Cloud Storage, you will need to have your own Google Project with a credit card added to the service, charges will apply. See the <a href="https://github.com/csaybar/GCS_AUTH_FILE.json">GCS_AUTH_FILE</a> tutorial to create your own service account key. If you want to understand why this is necessary, please have a look at <a href="http://code.markedmondson.me/googleCloudStorageR/articles/googleCloudStorageR.html">Mark Edmondson</a> tutorial.</p>
<p>Batch <strong>upload</strong> is a harder process, in <code>rgee</code> we try to make it simple. If you want to upload files in a batch way, firstly you must <strong>get authorization to read &amp; write into a Google Cloud Storage (GCS) bucket</strong>. <code>rgee</code> implement the next functions:</p>
<table class="table">
<caption>Table 2. Upload functions provided by the rgee package.</caption>
<thead><tr class="header">
<th></th>
<th></th>
<th align="center">FROM</th>
<th align="center">TO</th>
<th align="center">RETURN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Image</td>
<td>gcs_to_ee_image</td>
<td align="center">Cloud Storage</td>
<td align="center">EE asset</td>
<td align="center">EE Asset ID</td>
</tr>
<tr class="even">
<td></td>
<td>raster_as_ee</td>
<td align="center">Local</td>
<td align="center">EE asset</td>
<td align="center">EE Asset ID</td>
</tr>
<tr class="odd">
<td></td>
<td>stars_as_ee</td>
<td align="center">Local</td>
<td align="center">EE asset</td>
<td align="center">EE Asset ID</td>
</tr>
<tr class="even">
<td>Table</td>
<td>gcs_to_ee_table</td>
<td align="center">Cloud Storage</td>
<td align="center">EE asset</td>
<td align="center">EE Asset ID</td>
</tr>
<tr class="odd">
<td></td>
<td>sf_as_ee</td>
<td align="center">Local</td>
<td align="center">EE asset</td>
<td align="center">EE Asset ID</td>
</tr>
<tr class="even">
<td>Generic</td>
<td>local_to_gcs</td>
<td align="center">Local</td>
<td align="center">Cloud Storage</td>
<td align="center">GCS filename</td>
</tr>
</tbody>
</table>
<p>The upload process follows the same logic (Table 2). rgee includes <code>raster_as_ee</code> and <code>stars_as_ee</code> for uploading images and <code>sf_as_ee</code> for uploading vector data.</p>
</div>
<div id="authentication" class="section level2">
<h2 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h2>
<p>As we have seen previously, <code>rgee</code> deal with three different Google API’s:</p>
<ul>
<li>Google Earth Engine</li>
<li>Google Drive</li>
<li>Google Cloud Storage</li>
</ul>
<p>To authenticate either Google Drive or Google Cloud Storage, you just need to run as follow:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/rgee">rgee</a></span><span class="op">)</span>
<span class="co">#ee_reattach() # reattach ee as a reserve word</span>

<span class="co"># Initialize just Earth Engine</span>
<span class="fu"><a href="../reference/ee_Initialize.html">ee_Initialize</a></span><span class="op">(</span><span class="op">)</span> 
<span class="fu"><a href="../reference/ee_Initialize.html">ee_Initialize</a></span><span class="op">(</span>email <span class="op">=</span> <span class="st">'csaybar@gmail.com'</span><span class="op">)</span> <span class="co"># Use the argument email is not mandatory</span>

<span class="co"># Initialize Earth Engine and GD</span>
<span class="fu"><a href="../reference/ee_Initialize.html">ee_Initialize</a></span><span class="op">(</span>email <span class="op">=</span> <span class="st">'csaybar@gmail.com'</span>, drive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Initialize Earth Engine and GCS</span>
<span class="fu"><a href="../reference/ee_Initialize.html">ee_Initialize</a></span><span class="op">(</span>email <span class="op">=</span> <span class="st">'csaybar@gmail.com'</span>, gcs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Initialize Earth Engine, GD and GCS</span>
<span class="fu"><a href="../reference/ee_Initialize.html">ee_Initialize</a></span><span class="op">(</span>email <span class="op">=</span> <span class="st">'csaybar@gmail.com'</span>, drive <span class="op">=</span> <span class="cn">TRUE</span>, gcs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>If the Google account is verified and the permission is granted, you will be directed to an authentication token. Copy this token and paste it in the emerging GUI. Unlike Earth Engine and Google Drive, Google Cloud Storage need to set up its credential manually (<a href="http://code.markedmondson.me/googleCloudStorageR/articles/googleCloudStorageR.html">link1</a> and <a href="https://github.com/csaybar/GCS_AUTH_FILE.json">link2</a>). In all cases, the users credentials always will be stored in:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ee_get_earthengine_path.html">ee_get_earthengine_path</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Remember you only have to authorize once, for next sessions it will not be necessary.</p>
</div>
<div id="checking" class="section level2">
<h2 class="hasAnchor">
<a href="#checking" class="anchor"></a>Checking</h2>
<p>The <code><a href="../reference/ee_check-tools.html">ee_check()</a></code> function will help you for checking the sanity of your <code>rgee</code> installation and dependencies.</p>
<ul>
<li>
<code><a href="../reference/ee_check-tools.html">ee_check_python()</a></code> - Python version</li>
<li>
<code><a href="../reference/ee_check-tools.html">ee_check_credentials()</a></code> - Google Drive and GCS credentials</li>
<li>
<code><a href="../reference/ee_check-tools.html">ee_check_python_packages()</a></code> - Python packages</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/rgee">rgee</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/ee_check-tools.html">ee_check</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="../reference/ee_check-tools.html">ee_check_python</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/ee_check-tools.html">ee_check_credentials</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/ee_check-tools.html">ee_check_python_packages</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Cesar Aybar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
